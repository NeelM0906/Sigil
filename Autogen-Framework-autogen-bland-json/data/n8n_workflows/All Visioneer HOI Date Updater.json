{
  "name": "All Visioneer HOI Date Updater",
  "nodes": [
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        336,
        0
      ],
      "id": "171b66ef-662a-459c-9676-69d5878212fa",
      "name": "Respond to Webhook"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1xdSCBWrVd_ySND3LdLfieUn2NcO6kr5T0irRc3FbRZw",
          "mode": "list",
          "cachedResultName": "HOI/BAS Call Summaries",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1xdSCBWrVd_ySND3LdLfieUn2NcO6kr5T0irRc3FbRZw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1115047501,
          "mode": "list",
          "cachedResultName": "Scheduled HOI Calls",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1xdSCBWrVd_ySND3LdLfieUn2NcO6kr5T0irRc3FbRZw/edit#gid=1115047501"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Contact Email": "={{ $json.body.contact_email }}",
            "Contact Name": "={{ $json.body.contact_name }}",
            "Date Selected": "={{ $json.body.date_selected_hoi }}",
            "Referral Name": "={{ $json.body.referral_name }}",
            "Referral Email": "={{ $json.body.referral_email }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Contact Name",
              "displayName": "Contact Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Contact Email",
              "displayName": "Contact Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Date Selected",
              "displayName": "Date Selected",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Referral Name",
              "displayName": "Referral Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Referral Email",
              "displayName": "Referral Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -192,
        0
      ],
      "id": "0e4c3d6d-96ec-48fc-b2cb-b46cf5fc96b4",
      "name": "HOI Tracker",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "pGG9vHkc60ZLCVd8",
          "name": "Nick - Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=ðŸŸ¢ n8n Agent â€” HOI Show Finder\n\nROLE:\nYou are n8n, an ACTi scheduling agent.\nYour only job is to look up upcoming Heart of Influence (HOI) show interview times based on a personâ€™s name.\n\nGOAL:\nWhen I give you a name, return that personâ€™s HOI interview dates and times from our Google Calendar.\n\nRULES:\n\nAlways search by the name provided (not by email). You should be able to find the name in the event title in the calender\n\nLook up to 12 months ahead from today when checking the calendar.\n\nAll times must be displayed in Eastern Time (ET).\n\nIf no matches are found, simply reply:\n\nâ€œNo HOI interview dates found for [name].â€\nif the event says cancel dont include it into the payload\n\nINPUT :\n\n\"{{ $('Bland Webhook').item.json.body.referral_name }}â€\n\n\nOUTPUT FORMAT:\nList each date and time clearly, like:\n\nðŸ—“ï¸ month dd, YYYY â€” hh:mm PM â€“ hh:mm PM ET\nðŸ—“ï¸ month dd, YYYY â€” hh:mm PM â€“ hh:mm PM ET\nUPDATE EVENT PROTOCAL\nIf you receive a timestamp in ISO format from the webhook, it means the guest has agreed to join the show.\nWhen this happens, add their email to the event at that exact date and time on the HOI calendar.\nuse this information\nINPUT :\n{{ $('Bland Webhook').item.json.body.referral_name }}\nto search the calender to get the event ID in order to update the event to add the guest email in the update\n\nDATA FOR EVENT UPDATE\nguest email: {{ $('Bland Webhook').item.json.body.contact_email }}\nTimestamp: {{ $('Bland Webhook').item.json.body.date_selected_hoi }}\n",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        -48,
        0
      ],
      "id": "8a39374a-ae86-4f9e-ba02-746ddac3a8b7",
      "name": "Calendar Grandmaster"
    },
    {
      "parameters": {
        "jsCode": "// Use the existing output field from previous node\nconst rawOutput = $json.output ?? \"\";\n\n// Clean markdown and whitespace for ElevenLabs speech\nconst cleanedOutput = rawOutput\n  .replace(/[*_~`>#-]/g, \"\")     // remove markdown characters\n  .replace(/\\s+/g, \" \")          // normalize whitespace\n  .trim();\n\nreturn [\n  {\n    json: {\n      output: cleanedOutput\n    }\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        208,
        0
      ],
      "id": "0d8960a0-b085-4358-8d11-39da5f1d7b3f",
      "name": "Output"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-5-mini",
          "mode": "list",
          "cachedResultName": "gpt-5-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -48,
        208
      ],
      "id": "287bcdca-1c2c-45d6-ac01-f992adf66890",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "huH73fYuGpq0ogpt",
          "name": "OpenAi (ACTi)"
        }
      }
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "f847e676-ab2f-4d6c-9c84-fac729f0b7e5",
        "responseMode": "responseNode",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -352,
        0
      ],
      "id": "e2087e2e-d8ab-4e6b-ae98-a731dba10a67",
      "name": "Bland Webhook",
      "webhookId": "f847e676-ab2f-4d6c-9c84-fac729f0b7e5"
    },
    {
      "parameters": {
        "operation": "getAll",
        "calendar": {
          "__rl": true,
          "value": "heartofinfluence@unblindedmastery.com",
          "mode": "list",
          "cachedResultName": "Heart of Influence"
        },
        "returnAll": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Return_All', ``, 'boolean') }}",
        "timeMin": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('After', ``, 'string') }}",
        "timeMax": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Before', ``, 'string') }}",
        "options": {
          "query": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Query', ``, 'string') }}"
        }
      },
      "type": "n8n-nodes-base.googleCalendarTool",
      "typeVersion": 1.3,
      "position": [
        128,
        208
      ],
      "id": "a4345443-a6b3-4896-acbd-f2a7f6b213ea",
      "name": "Search HOI Calendar",
      "credentials": {
        "googleCalendarOAuth2Api": {
          "id": "SMmJviirvhZmalKK",
          "name": "Google Calendar account - superadmin"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "HOI Tracker": {
      "main": [
        [
          {
            "node": "Calendar Grandmaster",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Calendar Grandmaster": {
      "main": [
        [
          {
            "node": "Output",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Output": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Calendar Grandmaster",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Bland Webhook": {
      "main": [
        [
          {
            "node": "HOI Tracker",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search HOI Calendar": {
      "ai_tool": [
        [
          {
            "node": "Calendar Grandmaster",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "b45fbaeb-d800-4cb6-b0e0-062ba9cde8cc",
  "meta": {
    "instanceId": "0aed448db8bea3d866d9d07faa7651fc87999403a92df7fc5038094cffa1e1fe"
  },
  "id": "NMya2FfW2z1O8dmf",
  "tags": []
}